// ========================================
// Windows 数据（由用户提供）
// ========================================
export const WINDOWS_PRODUCTS = {
  // Windows客户端版本
  win11: 'Windows 11',
  win10: 'Windows 10',
  win81: 'Windows 8.1',
  win8: 'Windows 8',
  win7: 'Windows 7',
  winVista: 'Windows Vista',
  
  // Windows Server 版本
  winServer2025: 'Windows Server 2025',
  winServer2022: 'Windows Server 2022',
  winServer2019: 'Windows Server 2019',
  winServer2016: 'Windows Server 2016',
  winServer20H2: 'Windows Server 20H2',
  winServer2004: 'Windows Server 2004',
  winServer1909: 'Windows Server 1909',
  winServer1903: 'Windows Server 1903',
  winServer1809: 'Windows Server 1809',
  winServer1803: 'Windows Server 1803',
  winServer1709: 'Windows Server 1709',
  winServer2012R2: 'Windows Server 2012 R2',
  winServer2012: 'Windows Server 2012',
  winServer2008R2: 'Windows Server 2008 R2',
  winServer2008: 'Windows Server 2008'
};

export const WINDOWS_VERSIONS = {
  win11: {
    pro: '专业版',
    proN: '专业版 N',
    proWorkstation: '专业工作站版',
    proWorkstationN: '专业工作站版 N',
    proEducation: '专业教育版',
    proEducationN: '专业教育版 N',
    education: '教育版',
    educationN: '教育版 N',
    enterprise: '企业版',
    enterpriseN: '企业版 N',
    enterpriseG: '企业版 G',
    enterpriseGN: '企业版 G N'
  },
  win10: {
    pro: '专业版',
    proN: '专业版 N',
    proWorkstation: '专业工作站版',
    proWorkstationN: '专业工作站版 N',
    proEducation: '专业教育版',
    proEducationN: '专业教育版 N',
    education: '教育版',
    educationN: '教育版 N',
    enterprise: '企业版',
    enterpriseN: '企业版 N',
    enterpriseG: '企业版 G',
    enterpriseGN: '企业版 G N',
    home: '家庭版'
  },
  win81: {
    pro: '专业版',
    proN: '专业版 N',
    enterprise: '企业版',
    enterpriseN: '企业版 N'
  },
  win8: {
    pro: '专业版',
    proN: '专业版 N',
    enterprise: '企业版',
    enterpriseN: '企业版 N'
  },
  win7: {
    pro: '专业版',
    proN: '专业版 N',
    enterprise: '企业版',
    enterpriseN: '企业版 N',
    ult: '旗舰版'
  },
  winVista: {
    business: '商业版',
    businessN: '商业版 N',
    enterprise: '企业版',
    enterpriseN: '企业版 N'
  },
  // Server Versions (Default logic for servers usually maps standard/datacenter)
  winServer2025: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer2022: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer2019: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer2016: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer20H2: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer2004: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer1909: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer1903: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer1809: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer1803: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer1709: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer2012R2: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer2012: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer2008R2: { datacenter: 'Datacenter', standard: 'Standard' },
  winServer2008: { datacenter: 'Datacenter', standard: 'Standard' }
};

export const WINDOWS_KMS_KEYS = {
  win11: {
    pro: 'W269N-WFGWX-YVC9B-4J6C9-T83GX',
    proN: 'MH37W-N47XK-V7XM9-C7227-GCQG9',
    proWorkstation: 'NRG8B-VKK3Q-CXVCJ-9G2XF-6Q84J',
    proWorkstationN: '9FNHH-K3HBT-3W4TD-6383H-6XYWF',
    proEducation: '6TP4R-GNPTD-KYYHQ-7B7DP-J447Y',
    proEducationN: 'YVWGF-BXNMC-HTQYQ-CPQ99-66QFC',
    education: 'NW6C2-QMPVW-D7KKK-3GKT6-VCFB2',
    educationN: '2WH4N-8QGBV-H22JP-CT43Q-MDWWJ',
    enterprise: 'NPPR9-FWDCX-D2C8J-H872K-2YT43',
    enterpriseN: 'DPH2V-TTNVB-4X9Q3-TJR4H-KHJW4',
    enterpriseG: 'YVVX9-NTFWV-6MDM3-9PT4T-4M68B',
    enterpriseGN: '44RPN-FTY23-9VTTB-MP9BX-T84FV',
    home: 'TX9XD-98N7V-6WMQ6-BX7FG-H8Q99'
  },
  win10: {
    pro: 'W269N-WFGWX-YVC9B-4J6C9-T83GX',
    proN: 'MH37W-N47XK-V7XM9-C7227-GCQG9',
    proWorkstation: 'NRG8B-VKK3Q-CXVCJ-9G2XF-6Q84J',
    proWorkstationN: '9FNHH-K3HBT-3W4TD-6383H-6XYWF',
    proEducation: '6TP4R-GNPTD-KYYHQ-7B7DP-J447Y',
    proEducationN: 'YVWGF-BXNMC-HTQYQ-CPQ99-66QFC',
    education: 'NW6C2-QMPVW-D7KKK-3GKT6-VCFB2',
    educationN: '2WH4N-8QGBV-H22JP-CT43Q-MDWWJ',
    enterprise: 'NPPR9-FWDCX-D2C8J-H872K-2YT43',
    enterpriseN: 'DPH2V-TTNVB-4X9Q3-TJR4H-KHJW4',
    enterpriseG: 'YVVX9-NTFWV-6MDM3-9PT4T-4M68B',
    enterpriseGN: '44RPN-FTY23-9VTTB-MP9BX-T84FV',
    home: 'TX9XD-98N7V-6WMQ6-BX7FG-H8Q99'
  },
  win81: {
    pro: 'GCRJD-8NW9H-F2CDX-CCM8D-9D6T9',
    proN: 'HMCNV-VVBFX-7HMBH-CTY9B-B4FXY',
    enterprise: 'MHF9N-XY6XB-WVXMC-BTDCT-MKKG7',
    enterpriseN: 'TT4HM-HN7YT-62K67-RGRQJ-JFFXW'
  },
  win8: {
    pro: 'NG4HW-VH26C-733KW-K6F98-J8CK4',
    proN: 'XCVCF-2NXM9-723PB-MHCB7-2RYQQ',
    enterprise: 'NTTX3-RV7VB-T7X7F-WQYYY-9Y92F',
    enterpriseN: '2F77B-TNFGY-69QQF-B8YKP-D69TJ'
  },
  win7: {
    pro: 'FJ82H-XT6CR-J8D7P-XQJJ2-GPDD4',
    proN: 'MRPKT-YTG23-K7D7T-X2JMM-QY7MG',
    enterprise: '33PXH-7Y6KF-2VJC9-XBBR8-HVTHH',
    enterpriseN: 'YDRBP-3D83W-TY26F-D46B2-XCKRJ',
    ult: '342DG-6YJR8-X92GV-V7DCV-P4K27'
  },
  winVista: {
    business: 'VKK3X-68KWM-X2YGT-QR4M6-4BWMV',
    businessN: 'VTC42-BM838-43QHV-84HX6-XJXKV',
    enterprise: 'VMM7Q-4MQJB-4M78B-94GHX-74MYF',
    enterpriseN: '489J6-VHDMP-X63PK-3K798-CPX3Y'
  },
  winServer2025: { datacenter: 'WX4NM-KYWYW-QJJR4-XV3QB-6VM33', standard: 'VDYBN-27WPP-V4HQT-9VMD4-VMK7H' },
  winServer2022: { datacenter: 'WX4NM-KYWYW-QJJR4-XV3QB-6VM33', standard: 'VDYBN-27WPP-V4HQT-9VMD4-VMK7H' },
  winServer2019: { datacenter: 'WMDGN-G9PQG-XVVXX-R3X43-63DFG', standard: 'N69G4-B89J2-4G8F4-WWYCC-J464C' },
  winServer2016: { datacenter: 'CB7KF-BWN84-R7R2Y-793K2-8XDDG', standard: 'WC2BQ-8NRM3-FDDYY-2BFGV-KHKQY' },
  winServer20H2: { datacenter: '6NMRW-2C8FM-D24W7-TQWMY-CWH2D', standard: 'N2KJX-J94YW-TQVFB-DG9YT-724CC' },
  winServer2004: { datacenter: '6NMRW-2C8FM-D24W7-TQWMY-CWH2D', standard: 'N2KJX-J94YW-TQVFB-DG9YT-724CC' },
  winServer1909: { datacenter: '6NMRW-2C8FM-D24W7-TQWMY-CWH2D', standard: 'N2KJX-J94YW-TQVFB-DG9YT-724CC' },
  winServer1903: { datacenter: '6NMRW-2C8FM-D24W7-TQWMY-CWH2D', standard: 'N2KJX-J94YW-TQVFB-DG9YT-724CC' },
  winServer1809: { datacenter: '6NMRW-2C8FM-D24W7-TQWMY-CWH2D', standard: 'N2KJX-J94YW-TQVFB-DG9YT-724CC' },
  winServer1803: { datacenter: '2HXDN-KRXHB-GPYC7-YCK7R-XDR8Y', standard: '4YR27-NTD24-H823Y-72MTF-YWMBB' },
  winServer1709: { datacenter: '6Y6KB-BWBYW-9GQ4D-3YXFB-BV7F7', standard: 'N4F7V-WT9B3-4PBNQ-8D8XV-WHGXV' },
  winServer2012R2: { datacenter: 'Y4TGP-NPTV9-HTC2H-7MGQ3-DV2XB', standard: 'D2N9P-3P6X9-2R39C-7RTCD-MDVJX' },
  winServer2012: { datacenter: '48HP8-DN98B-MYWDG-T2DCC-8W83P', standard: 'YC6KT-GKW9T-YTKYR-T4X34-R7VHC' },
  winServer2008R2: { datacenter: '74YFP-3QFB3-KQT8W-PMXWJ-7M648', standard: 'YC6WR-KF7CD-KK3CX-6T4X4-RHW28' },
  winServer2008: { datacenter: '489J6-VHDMP-X63PK-3K798-CPX3Y', standard: 'TM24T-X9RMF-VWXK6-X8JC9-BFGM2' }
};

// 将新的 Windows 数据转换为现有 UI 可用的扁平结构
function buildWindowsKeys() {
  return Object.entries(WINDOWS_KMS_KEYS).flatMap(([productKey, versions]) => {
    const productName = WINDOWS_PRODUCTS[productKey] || productKey;
    const versionLabels = WINDOWS_VERSIONS[productKey] || {};

    return Object.entries(versions).map(([versionKey, kmsKey]) => {
      const label = versionLabels[versionKey] || versionKey;
      return {
        version: `${productName} ${label}`,
        key: kmsKey,
        category: productName
      };
    });
  });
}

export const windowsKeys = buildWindowsKeys();

/**
 * Office GVLK 密钥数据
 * 来源: https://learn.microsoft.com/zh-cn/deployoffice/vlactivation/gvlks
 */
export const officeKeys = [
    // Office LTSC 2024
    { version: 'Office LTSC 专业增强版 2024', key: '2TDPW-NDQ7G-FMG99-DXQ7M-TX3T2', category: 'Office 2024' },
    { version: 'Office LTSC 标准版 2024', key: 'V28N4-JG22K-W66P8-VTMGK-H6HGR', category: 'Office 2024' },

    // Office LTSC 2021
    { version: 'Office LTSC 专业增强版 2021', key: 'FXYTK-NJJ8C-GB6DW-3DYQT-6F7TH', category: 'Office 2021' },
    { version: 'Office LTSC 标准版 2021', key: 'KDX7X-BNVR8-TXXGX-4Q7Y8-78VT3', category: 'Office 2021' },
    { version: 'Project 专业版 2021', key: 'FTNWT-C6WBT-8HMGF-K9PRX-QV9H8', category: 'Office 2021' },
    { version: 'Project 标准版 2021', key: 'J2JDC-NJCYY-9RGQ4-YXWMH-T3D4T', category: 'Office 2021' },
    { version: 'Visio LTSC 专业版 2021', key: 'KNH8D-FGHT4-T8RK3-CTDYJ-K2HT4', category: 'Office 2021' },
    { version: 'Visio LTSC 标准版 2021', key: 'MJVNY-BYWPY-CWV6J-2RKRT-4M8QG', category: 'Office 2021' },
    { version: 'Access LTSC 2021', key: 'WM8YG-YNGDD-4JHDC-PG3F4-FC4T4', category: 'Office 2021' },
    { version: 'Excel LTSC 2021', key: 'NWG3X-87C9K-TC7YY-BC2G7-G6RVC', category: 'Office 2021' },
    { version: 'Outlook LTSC 2021', key: 'C9FM6-3N72F-HFJXB-TM3V9-T86R9', category: 'Office 2021' },
    { version: 'PowerPoint LTSC 2021', key: 'TY7XF-NFRBR-KJ44C-G83KF-GX27K', category: 'Office 2021' },
    { version: 'Publisher LTSC 2021', key: '2MW9D-N4BXM-9VBPG-Q7W6M-KFBGQ', category: 'Office 2021' },
    { version: 'Skype for Business LTSC 2021', key: 'HWCXN-K3WBT-WJBKY-R8BD9-XK29P', category: 'Office 2021' },
    { version: 'Word LTSC 2021', key: 'TN8H9-M34D3-Y64V9-TR72V-X79KV', category: 'Office 2021' },

    // Office 2019
    { version: 'Office 专业增强版 2019', key: 'NMMKJ-6RK4F-KMJVX-8D9MJ-6MWKP', category: 'Office 2019' },
    { version: 'Office 标准版 2019', key: '6NWWJ-YQWMR-QKGCB-6TMB3-9D9HK', category: 'Office 2019' },
    { version: 'Project 专业版 2019', key: 'B4NPR-3FKK7-T2MBV-FRQ4W-PKD2B', category: 'Office 2019' },
    { version: 'Project 标准版 2019', key: 'C4F7P-NCP8C-6CQPT-MQHV9-JXD2M', category: 'Office 2019' },
    { version: 'Visio 专业版 2019', key: '9BGNQ-K37YR-RQHF2-38RQ3-7VCBB', category: 'Office 2019' },
    { version: 'Visio 标准版 2019', key: '7TQNQ-K3YQQ-3PFH7-CCPPM-X4VQ2', category: 'Office 2019' },
    { version: 'Access 2019', key: '9N9PT-27V4Y-VJ2PD-YXFMF-YTFQT', category: 'Office 2019' },
    { version: 'Excel 2019', key: 'TMJWT-YYNMB-3BKTF-644FC-RVXBD', category: 'Office 2019' },
    { version: 'Outlook 2019', key: '7HD7K-N4PVK-BHBCQ-YWQRW-XW4VK', category: 'Office 2019' },
    { version: 'PowerPoint 2019', key: 'RRNCX-C64HY-W2MM7-MCH9G-TJHMQ', category: 'Office 2019' },
    { version: 'Publisher 2019', key: 'G2KWX-3NW6P-PY93R-JXK2T-C9Y9V', category: 'Office 2019' },
    { version: 'Skype for Business 2019', key: 'NCJ33-JHBBY-HTK98-MYCV8-HMKHJ', category: 'Office 2019' },
    { version: 'Word 2019', key: 'PBX3G-NWMT6-Q7XBW-PYJGG-WXD33', category: 'Office 2019' },

    // Office 2016
    { version: 'Office 专业增强版 2016', key: 'XQNVK-8JYDB-WJ9W3-YJ8YR-WFG99', category: 'Office 2016' },
    { version: 'Office 标准版 2016', key: 'JNRGM-WHDWX-FJJG3-K47QV-DRTFM', category: 'Office 2016' },
    { version: 'Project 专业版 2016', key: 'YG9NW-3K39V-2T3HJ-93F3Q-G83KT', category: 'Office 2016' },
    { version: 'Project 标准版 2016', key: 'GNFHQ-F6YQM-KQDGJ-327XX-KQBVC', category: 'Office 2016' },
    { version: 'Visio 专业版 2016', key: 'PD3PC-RHNGV-FXJ29-8JK7D-RJRJK', category: 'Office 2016' },
    { version: 'Visio 标准版 2016', key: '7WHWN-4T7MP-G96JF-G33KR-W8GF4', category: 'Office 2016' },
    { version: 'Access 2016', key: 'GNH9Y-D2J4T-FJHGG-QRVH7-QPFDW', category: 'Office 2016' },
    { version: 'Excel 2016', key: '9C2PK-NWTVB-JMPW8-BFT28-7FTBF', category: 'Office 2016' },
    { version: 'OneNote 2016', key: 'DR92N-9HTF2-97XKM-XW2WJ-XW3J6', category: 'Office 2016' },
    { version: 'Outlook 2016', key: 'R69KK-NTPKF-7M3Q4-QYBHW-6MT9B', category: 'Office 2016' },
    { version: 'PowerPoint 2016', key: 'J7MQP-HNJ4Y-WJ7YM-PFYGF-BY6C6', category: 'Office 2016' },
    { version: 'Publisher 2016', key: 'F47MM-N3XJP-TQXJ9-BP99D-8837K', category: 'Office 2016' },
    { version: 'Skype for Business 2016', key: '869NQ-FJ69K-466HW-QYCP2-DDBV6', category: 'Office 2016' },
    { version: 'Word 2016', key: 'WXY84-JN2Q9-RBCCQ-3Q3J3-3PFJ6', category: 'Office 2016' },
];

/**
 * 获取所有 Windows 分类
 */
export function getWindowsCategories() {
    return [...new Set(windowsKeys.map(item => item.category))];
}

/**
 * 获取所有 Office 分类
 */
export function getOfficeCategories() {
    return [...new Set(officeKeys.map(item => item.category))];
}

/**
 * 根据分类筛选 Windows 密钥
 */
export function getWindowsKeysByCategory(category) {
    if (!category) return windowsKeys;
    return windowsKeys.filter(item => item.category === category);
}

/**
 * 根据分类筛选 Office 密钥
 */
export function getOfficeKeysByCategory(category) {
    if (!category) return officeKeys;
    return officeKeys.filter(item => item.category === category);
}
